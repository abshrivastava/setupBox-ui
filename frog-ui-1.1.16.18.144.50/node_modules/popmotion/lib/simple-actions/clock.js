'use strict';

exports.__esModule = true;
exports.default = clock;

var _Action2 = require('./Action');

var _Action3 = _interopRequireDefault(_Action2);

var _utils = require('../inc/utils');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var MAX_ELAPSED = 33;

var Clock = function (_Action) {
  _inherits(Clock, _Action);

  function Clock() {
    _classCallCheck(this, Clock);

    return _possibleConstructorReturn(this, _Action.apply(this, arguments));
  }

  Clock.prototype.onStart = function onStart() {
    this.current = (0, _utils.currentTime)();
  };

  Clock.prototype.onUpdate = function onUpdate(framestamp) {
    var elapsed = Math.min(framestamp - this.current, MAX_ELAPSED) * this.dilate;
    this.current += elapsed;
  };

  return Clock;
}(_Action3.default);

Clock.defaultProps = {
  dilate: 1
};

function clock(props) {
  return new Clock(props);
};

function flatten() {}

// // http://www.gamasutra.com/view/feature/131863/animation_blending_achieving_.php
// class CompositeAction extends Action {
//   constructor(props) {
//     super(props);
//     this.children = [];
//     this.numChildren = 0;
//     this.flattenList = [];
//   }

//   addAction(action) {
//     this.children.push({
//       action,
//       force,
//       weight: 0
//     });

//     this.numChildren++;
//   }

//   removeAction(action) {

//   }

//   onUpdate(framestamp) {
//     const numChildren = this.children.length;

//     for (let i = 0; i < numChildren; i++) {
//       this.children[i].onUpdate(framestamp);
//     }

//     flatten(this);

//     //blend
//     let currentWeight = 0;

//     for (i = 0; i < this.flattenList.length; i++) {
//       const item = this.flattenList[i];
//       if (item.blendWeight) {
//         currentWeight += item.blendWeight;
//         const interpolation = item.blendWeight / currentWeight;
//         blendChannels(buffer, item, interpolation);
//       }
//     }

//     function blendTwoTweens(a, b) {
//       const aEasedProgress
//       const bEasedProgress
//       const [aEasedProgress, 1] -> [0, 1]
//       const [bEasedProgress, 1] -> [0, 1]
//       const 
//     }
//   }
// }
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zaW1wbGUtYWN0aW9ucy9jbG9jay5qcyJdLCJuYW1lcyI6WyJjbG9jayIsIk1BWF9FTEFQU0VEIiwiQ2xvY2siLCJvblN0YXJ0IiwiY3VycmVudCIsIm9uVXBkYXRlIiwiZnJhbWVzdGFtcCIsImVsYXBzZWQiLCJNYXRoIiwibWluIiwiZGlsYXRlIiwiZGVmYXVsdFByb3BzIiwicHJvcHMiLCJmbGF0dGVuIl0sIm1hcHBpbmdzIjoiOzs7a0JBb0J3QkEsSzs7QUFwQnhCOzs7O0FBQ0E7Ozs7Ozs7Ozs7QUFFQSxJQUFNQyxjQUFjLEVBQXBCOztJQUVNQyxLO1lBQUFBLEs7O1dBQUFBLEs7MEJBQUFBLEs7Ozs7O0FBQUFBLE8sV0FDSkMsTyxzQkFBVTtBQUNSLFNBQUtDLE9BQUwsR0FBZSx5QkFBZjtBQUNELEc7O0FBSEdGLE8sV0FLSkcsUSxxQkFBU0MsVSxFQUFZO0FBQ25CLFFBQU1DLFVBQVVDLEtBQUtDLEdBQUwsQ0FBU0gsYUFBYSxLQUFLRixPQUEzQixFQUFvQ0gsV0FBcEMsSUFBbUQsS0FBS1MsTUFBeEU7QUFDQSxTQUFLTixPQUFMLElBQWdCRyxPQUFoQjtBQUNELEc7O1NBUkdMLEs7OztBQVdOQSxNQUFNUyxZQUFOLEdBQXFCO0FBQ25CRCxVQUFRO0FBRFcsQ0FBckI7O0FBSWUsU0FBU1YsS0FBVCxDQUFlWSxLQUFmLEVBQXNCO0FBQ25DLFNBQU8sSUFBSVYsS0FBSixDQUFVVSxLQUFWLENBQVA7QUFDRDs7QUFFRCxTQUFTQyxPQUFULEdBQW1CLENBRWxCOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJjbG9jay5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBBY3Rpb24gZnJvbSAnLi9BY3Rpb24nO1xuaW1wb3J0IHsgY3VycmVudFRpbWUgfSBmcm9tICcuLi9pbmMvdXRpbHMnO1xuXG5jb25zdCBNQVhfRUxBUFNFRCA9IDMzO1xuXG5jbGFzcyBDbG9jayBleHRlbmRzIEFjdGlvbiB7XG4gIG9uU3RhcnQoKSB7XG4gICAgdGhpcy5jdXJyZW50ID0gY3VycmVudFRpbWUoKTtcbiAgfVxuXG4gIG9uVXBkYXRlKGZyYW1lc3RhbXApIHtcbiAgICBjb25zdCBlbGFwc2VkID0gTWF0aC5taW4oZnJhbWVzdGFtcCAtIHRoaXMuY3VycmVudCwgTUFYX0VMQVBTRUQpICogdGhpcy5kaWxhdGU7XG4gICAgdGhpcy5jdXJyZW50ICs9IGVsYXBzZWQ7XG4gIH1cbn1cblxuQ2xvY2suZGVmYXVsdFByb3BzID0ge1xuICBkaWxhdGU6IDFcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNsb2NrKHByb3BzKSB7XG4gIHJldHVybiBuZXcgQ2xvY2socHJvcHMpO1xufTtcblxuZnVuY3Rpb24gZmxhdHRlbigpIHtcblxufVxuXG4vLyAvLyBodHRwOi8vd3d3LmdhbWFzdXRyYS5jb20vdmlldy9mZWF0dXJlLzEzMTg2My9hbmltYXRpb25fYmxlbmRpbmdfYWNoaWV2aW5nXy5waHBcbi8vIGNsYXNzIENvbXBvc2l0ZUFjdGlvbiBleHRlbmRzIEFjdGlvbiB7XG4vLyAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4vLyAgICAgc3VwZXIocHJvcHMpO1xuLy8gICAgIHRoaXMuY2hpbGRyZW4gPSBbXTtcbi8vICAgICB0aGlzLm51bUNoaWxkcmVuID0gMDtcbi8vICAgICB0aGlzLmZsYXR0ZW5MaXN0ID0gW107XG4vLyAgIH1cblxuLy8gICBhZGRBY3Rpb24oYWN0aW9uKSB7XG4vLyAgICAgdGhpcy5jaGlsZHJlbi5wdXNoKHtcbi8vICAgICAgIGFjdGlvbixcbi8vICAgICAgIGZvcmNlLFxuLy8gICAgICAgd2VpZ2h0OiAwXG4vLyAgICAgfSk7XG5cbi8vICAgICB0aGlzLm51bUNoaWxkcmVuKys7XG4vLyAgIH1cblxuLy8gICByZW1vdmVBY3Rpb24oYWN0aW9uKSB7XG5cbi8vICAgfVxuXG4vLyAgIG9uVXBkYXRlKGZyYW1lc3RhbXApIHtcbi8vICAgICBjb25zdCBudW1DaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW4ubGVuZ3RoO1xuXG4vLyAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1DaGlsZHJlbjsgaSsrKSB7XG4vLyAgICAgICB0aGlzLmNoaWxkcmVuW2ldLm9uVXBkYXRlKGZyYW1lc3RhbXApO1xuLy8gICAgIH1cblxuLy8gICAgIGZsYXR0ZW4odGhpcyk7XG5cbi8vICAgICAvL2JsZW5kXG4vLyAgICAgbGV0IGN1cnJlbnRXZWlnaHQgPSAwO1xuXG4vLyAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMuZmxhdHRlbkxpc3QubGVuZ3RoOyBpKyspIHtcbi8vICAgICAgIGNvbnN0IGl0ZW0gPSB0aGlzLmZsYXR0ZW5MaXN0W2ldO1xuLy8gICAgICAgaWYgKGl0ZW0uYmxlbmRXZWlnaHQpIHtcbi8vICAgICAgICAgY3VycmVudFdlaWdodCArPSBpdGVtLmJsZW5kV2VpZ2h0O1xuLy8gICAgICAgICBjb25zdCBpbnRlcnBvbGF0aW9uID0gaXRlbS5ibGVuZFdlaWdodCAvIGN1cnJlbnRXZWlnaHQ7XG4vLyAgICAgICAgIGJsZW5kQ2hhbm5lbHMoYnVmZmVyLCBpdGVtLCBpbnRlcnBvbGF0aW9uKTtcbi8vICAgICAgIH1cbi8vICAgICB9XG5cbi8vICAgICBmdW5jdGlvbiBibGVuZFR3b1R3ZWVucyhhLCBiKSB7XG4vLyAgICAgICBjb25zdCBhRWFzZWRQcm9ncmVzc1xuLy8gICAgICAgY29uc3QgYkVhc2VkUHJvZ3Jlc3Ncbi8vICAgICAgIGNvbnN0IFthRWFzZWRQcm9ncmVzcywgMV0gLT4gWzAsIDFdXG4vLyAgICAgICBjb25zdCBbYkVhc2VkUHJvZ3Jlc3MsIDFdIC0+IFswLCAxXVxuLy8gICAgICAgY29uc3QgXG4vLyAgICAgfVxuLy8gICB9XG4vLyB9XG5cbiJdfQ==