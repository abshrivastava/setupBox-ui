'use strict';

exports.__esModule = true;

var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _ = require('./');

var _2 = _interopRequireDefault(_);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var CompositeAction = function (_Action) {
  _inherits(CompositeAction, _Action);

  function CompositeAction(props) {
    _classCallCheck(this, CompositeAction);

    var actions = props.actions;

    var remainingProps = _objectWithoutProperties(props, ['actions']);

    var _this = _possibleConstructorReturn(this, _Action.call(this, remainingProps));

    _this.current = {};
    _this.actionKeys = [];
    _this.addActions(props.actions);
    return _this;
  }

  CompositeAction.prototype.addActions = function addActions(actions) {
    var _this2 = this;

    var _loop = function (key) {
      if (_this2.actionKeys.indexOf(key) === -1) {
        _this2.actionKeys.push(key);
      }

      _this2[key] = actions[key];
      _this2[key].setProps({
        // Look into private settable functions
        _onUpdate: function (v, action) {
          _this2.current[key] = action.get();
        },
        _onStop: function () {
          return _this2.numActiveActions--;
        }
      });
    };

    for (var key in actions) {
      _loop(key);
    }
  };

  CompositeAction.prototype.onStart = function onStart() {
    var _this3 = this;

    this.numActiveActions = this.actionKeys.length;
    this.actionKeys.forEach(function (key) {
      return _this3[key].start();
    });
  };

  CompositeAction.prototype.onStop = function onStop() {
    var _this4 = this;

    this.actionKeys.forEach(function (key) {
      return _this4[key].stop();
    });
  };

  CompositeAction.prototype.getVelocity = function getVelocity() {
    var _this5 = this;

    var velocity = {};
    this.actionKeys.forEach(function (key) {
      return velocity[key] = _this5[key].getVelocity();
    });
    return velocity;
  };

  CompositeAction.prototype.isActionComplete = function isActionComplete() {
    return this.numActiveActions === 0;
  };

  return CompositeAction;
}(_2.default);

exports.default = function (actions, props) {
  return new CompositeAction(_extends({
    actions: actions
  }, props));
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9hY3Rpb25zL2NvbXBvc2l0ZS5qcyJdLCJuYW1lcyI6WyJDb21wb3NpdGVBY3Rpb24iLCJwcm9wcyIsImFjdGlvbnMiLCJyZW1haW5pbmdQcm9wcyIsImN1cnJlbnQiLCJhY3Rpb25LZXlzIiwiYWRkQWN0aW9ucyIsImtleSIsImluZGV4T2YiLCJwdXNoIiwic2V0UHJvcHMiLCJfb25VcGRhdGUiLCJ2IiwiYWN0aW9uIiwiZ2V0IiwiX29uU3RvcCIsIm51bUFjdGl2ZUFjdGlvbnMiLCJvblN0YXJ0IiwibGVuZ3RoIiwiZm9yRWFjaCIsInN0YXJ0Iiwib25TdG9wIiwic3RvcCIsImdldFZlbG9jaXR5IiwidmVsb2NpdHkiLCJpc0FjdGlvbkNvbXBsZXRlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTs7Ozs7Ozs7Ozs7Ozs7SUFFTUEsZTtZQUFBQSxlOztBQUNKLFdBRElBLGVBQ0osQ0FBWUMsS0FBWixFQUFtQjtBQUFBLDBCQURmRCxlQUNlOztBQUFBLFFBQ1RFLE9BRFMsR0FDc0JELEtBRHRCLENBQ1RDLE9BRFM7O0FBQUEsUUFDR0MsY0FESCw0QkFDc0JGLEtBRHRCOztBQUFBLGlEQUVqQixtQkFBTUUsY0FBTixDQUZpQjs7QUFHakIsVUFBS0MsT0FBTCxHQUFlLEVBQWY7QUFDQSxVQUFLQyxVQUFMLEdBQWtCLEVBQWxCO0FBQ0EsVUFBS0MsVUFBTCxDQUFnQkwsTUFBTUMsT0FBdEI7QUFMaUI7QUFNbEI7O0FBUEdGLGlCLFdBU0pNLFUsdUJBQVdKLE8sRUFBUztBQUFBOztBQUFBLDBCQUNQSyxHQURPO0FBRWhCLFVBQUksT0FBS0YsVUFBTCxDQUFnQkcsT0FBaEIsQ0FBd0JELEdBQXhCLE1BQWlDLENBQUMsQ0FBdEMsRUFBeUM7QUFDdkMsZUFBS0YsVUFBTCxDQUFnQkksSUFBaEIsQ0FBcUJGLEdBQXJCO0FBQ0Q7O0FBRUQsYUFBS0EsR0FBTCxJQUFZTCxRQUFRSyxHQUFSLENBQVo7QUFDQSxhQUFLQSxHQUFMLEVBQVVHLFFBQVYsQ0FBbUI7QUFDakI7QUFDQUMsbUJBQVcsVUFBQ0MsQ0FBRCxFQUFJQyxNQUFKLEVBQWU7QUFDeEIsaUJBQUtULE9BQUwsQ0FBYUcsR0FBYixJQUFvQk0sT0FBT0MsR0FBUCxFQUFwQjtBQUNELFNBSmdCO0FBS2pCQyxpQkFBUztBQUFBLGlCQUFNLE9BQUtDLGdCQUFMLEVBQU47QUFBQTtBQUxRLE9BQW5CO0FBUGdCOztBQUNsQixTQUFLLElBQU1ULEdBQVgsSUFBa0JMLE9BQWxCLEVBQTJCO0FBQUEsWUFBaEJLLEdBQWdCO0FBYTFCO0FBQ0YsRzs7QUF4QkdQLGlCLFdBMEJKaUIsTyxzQkFBVTtBQUFBOztBQUNSLFNBQUtELGdCQUFMLEdBQXdCLEtBQUtYLFVBQUwsQ0FBZ0JhLE1BQXhDO0FBQ0EsU0FBS2IsVUFBTCxDQUFnQmMsT0FBaEIsQ0FBd0IsVUFBQ1osR0FBRDtBQUFBLGFBQVMsT0FBS0EsR0FBTCxFQUFVYSxLQUFWLEVBQVQ7QUFBQSxLQUF4QjtBQUNELEc7O0FBN0JHcEIsaUIsV0ErQkpxQixNLHFCQUFTO0FBQUE7O0FBQ1AsU0FBS2hCLFVBQUwsQ0FBZ0JjLE9BQWhCLENBQXdCLFVBQUNaLEdBQUQ7QUFBQSxhQUFTLE9BQUtBLEdBQUwsRUFBVWUsSUFBVixFQUFUO0FBQUEsS0FBeEI7QUFDRCxHOztBQWpDR3RCLGlCLFdBbUNKdUIsVywwQkFBYztBQUFBOztBQUNaLFFBQU1DLFdBQVcsRUFBakI7QUFDQSxTQUFLbkIsVUFBTCxDQUFnQmMsT0FBaEIsQ0FBd0IsVUFBQ1osR0FBRDtBQUFBLGFBQVNpQixTQUFTakIsR0FBVCxJQUFnQixPQUFLQSxHQUFMLEVBQVVnQixXQUFWLEVBQXpCO0FBQUEsS0FBeEI7QUFDQSxXQUFPQyxRQUFQO0FBQ0QsRzs7QUF2Q0d4QixpQixXQXlDSnlCLGdCLCtCQUFtQjtBQUNqQixXQUFRLEtBQUtULGdCQUFMLEtBQTBCLENBQWxDO0FBQ0QsRzs7U0EzQ0doQixlOzs7a0JBOENTLFVBQUNFLE9BQUQsRUFBVUQsS0FBVixFQUFvQjtBQUNqQyxTQUFPLElBQUlELGVBQUo7QUFDTEU7QUFESyxLQUVGRCxLQUZFLEVBQVA7QUFJRCxDIiwiZmlsZSI6ImNvbXBvc2l0ZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBBY3Rpb24gZnJvbSAnLi8nO1xuXG5jbGFzcyBDb21wb3NpdGVBY3Rpb24gZXh0ZW5kcyBBY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgIGNvbnN0IHsgYWN0aW9ucywgLi4ucmVtYWluaW5nUHJvcHMgfSA9IHByb3BzO1xuICAgIHN1cGVyKHJlbWFpbmluZ1Byb3BzKTtcbiAgICB0aGlzLmN1cnJlbnQgPSB7fTtcbiAgICB0aGlzLmFjdGlvbktleXMgPSBbXTtcbiAgICB0aGlzLmFkZEFjdGlvbnMocHJvcHMuYWN0aW9ucyk7XG4gIH1cblxuICBhZGRBY3Rpb25zKGFjdGlvbnMpIHtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBhY3Rpb25zKSB7XG4gICAgICBpZiAodGhpcy5hY3Rpb25LZXlzLmluZGV4T2Yoa2V5KSA9PT0gLTEpIHtcbiAgICAgICAgdGhpcy5hY3Rpb25LZXlzLnB1c2goa2V5KTtcbiAgICAgIH1cblxuICAgICAgdGhpc1trZXldID0gYWN0aW9uc1trZXldO1xuICAgICAgdGhpc1trZXldLnNldFByb3BzKHtcbiAgICAgICAgLy8gTG9vayBpbnRvIHByaXZhdGUgc2V0dGFibGUgZnVuY3Rpb25zXG4gICAgICAgIF9vblVwZGF0ZTogKHYsIGFjdGlvbikgPT4ge1xuICAgICAgICAgIHRoaXMuY3VycmVudFtrZXldID0gYWN0aW9uLmdldCgpO1xuICAgICAgICB9LFxuICAgICAgICBfb25TdG9wOiAoKSA9PiB0aGlzLm51bUFjdGl2ZUFjdGlvbnMtLVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgb25TdGFydCgpIHtcbiAgICB0aGlzLm51bUFjdGl2ZUFjdGlvbnMgPSB0aGlzLmFjdGlvbktleXMubGVuZ3RoO1xuICAgIHRoaXMuYWN0aW9uS2V5cy5mb3JFYWNoKChrZXkpID0+IHRoaXNba2V5XS5zdGFydCgpKTtcbiAgfVxuXG4gIG9uU3RvcCgpIHtcbiAgICB0aGlzLmFjdGlvbktleXMuZm9yRWFjaCgoa2V5KSA9PiB0aGlzW2tleV0uc3RvcCgpKTtcbiAgfVxuXG4gIGdldFZlbG9jaXR5KCkge1xuICAgIGNvbnN0IHZlbG9jaXR5ID0ge307XG4gICAgdGhpcy5hY3Rpb25LZXlzLmZvckVhY2goKGtleSkgPT4gdmVsb2NpdHlba2V5XSA9IHRoaXNba2V5XS5nZXRWZWxvY2l0eSgpKTtcbiAgICByZXR1cm4gdmVsb2NpdHk7XG4gIH1cblxuICBpc0FjdGlvbkNvbXBsZXRlKCkge1xuICAgIHJldHVybiAodGhpcy5udW1BY3RpdmVBY3Rpb25zID09PSAwKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCAoYWN0aW9ucywgcHJvcHMpID0+IHtcbiAgcmV0dXJuIG5ldyBDb21wb3NpdGVBY3Rpb24oe1xuICAgIGFjdGlvbnMsXG4gICAgLi4ucHJvcHNcbiAgfSk7XG59O1xuIl19