"use strict";

exports.__esModule = true;

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Value = exports.Value = function () {
  function Value(initialValue, type) {
    _classCallCheck(this, Value);

    this.current = initialValue;
    this.type = type;
    this.action = null;
  }

  Value.prototype.update = function update(newValue) {
    this.current = newValue;
    this.__fireListeners();
  };

  Value.prototype.get = function get() {
    return this.current;
  };

  Value.prototype.getVelocity = function getVelocity() {
    return this.action ? this.action.getVelocity : 0;
  };

  Value.prototype.stop = function stop() {
    if (this.action) {
      this.action.stop();
      this.action = null;
    }

    return this;
  };

  Value.prototype.registerAction = function registerAction(action) {
    var _this = this;

    if (this.action) {
      this.action.stop();
    }

    this.action = action;

    // Potential todo: Check if source action is this.action
    return function (v) {
      return _this.update(v);
    };
  };

  Value.prototype.addListener = function addListener(callback) {
    if (!this.listeners) {
      this.listeners = [];
    }

    var listenerIndex = this.listeners.indexOf(callback);
    if (listenerIndex === -1) {
      this.listeners.push(callback);
    }

    return this;
  };

  Value.prototype.removeListener = function removeListener(callback) {
    if (this.listeners) {
      var listenerIndex = this.listeners.indexOf(callback);
      if (listenerIndex > -1) {
        this.listeners.splice(listenerIndex, 1);
      }
    }

    return this;
  };

  Value.prototype.__fireListeners = function __fireListeners() {
    if (this.listeners) {
      var numListeners = this.listeners.length;
      for (var i = 0; i < numListeners; i++) {
        this.listeners[i](this.current, this);
      }
    }
  };

  return Value;
}();

exports.default = function (initialValue) {
  return new Value(initialValue);
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy92YWx1ZS9pbmRleC5qcyJdLCJuYW1lcyI6WyJWYWx1ZSIsImluaXRpYWxWYWx1ZSIsInR5cGUiLCJjdXJyZW50IiwiYWN0aW9uIiwidXBkYXRlIiwibmV3VmFsdWUiLCJfX2ZpcmVMaXN0ZW5lcnMiLCJnZXQiLCJnZXRWZWxvY2l0eSIsInN0b3AiLCJyZWdpc3RlckFjdGlvbiIsInYiLCJhZGRMaXN0ZW5lciIsImNhbGxiYWNrIiwibGlzdGVuZXJzIiwibGlzdGVuZXJJbmRleCIsImluZGV4T2YiLCJwdXNoIiwicmVtb3ZlTGlzdGVuZXIiLCJzcGxpY2UiLCJudW1MaXN0ZW5lcnMiLCJsZW5ndGgiLCJpIl0sIm1hcHBpbmdzIjoiOzs7Ozs7SUFBYUEsSyxXQUFBQSxLO0FBQ1gsV0FEV0EsS0FDWCxDQUFZQyxZQUFaLEVBQTBCQyxJQUExQixFQUFnQztBQUFBLDBCQURyQkYsS0FDcUI7O0FBQzlCLFNBQUtHLE9BQUwsR0FBZUYsWUFBZjtBQUNBLFNBQUtDLElBQUwsR0FBWUEsSUFBWjtBQUNBLFNBQUtFLE1BQUwsR0FBYyxJQUFkO0FBQ0Q7O0FBTFVKLE8sV0FPWEssTSxtQkFBT0MsUSxFQUFVO0FBQ2YsU0FBS0gsT0FBTCxHQUFlRyxRQUFmO0FBQ0EsU0FBS0MsZUFBTDtBQUNELEc7O0FBVlVQLE8sV0FZWFEsRyxrQkFBTTtBQUNKLFdBQU8sS0FBS0wsT0FBWjtBQUNELEc7O0FBZFVILE8sV0FnQlhTLFcsMEJBQWM7QUFDWixXQUFRLEtBQUtMLE1BQU4sR0FBZ0IsS0FBS0EsTUFBTCxDQUFZSyxXQUE1QixHQUEwQyxDQUFqRDtBQUNELEc7O0FBbEJVVCxPLFdBb0JYVSxJLG1CQUFPO0FBQ0wsUUFBSSxLQUFLTixNQUFULEVBQWlCO0FBQ2YsV0FBS0EsTUFBTCxDQUFZTSxJQUFaO0FBQ0EsV0FBS04sTUFBTCxHQUFjLElBQWQ7QUFDRDs7QUFFRCxXQUFPLElBQVA7QUFDRCxHOztBQTNCVUosTyxXQTZCWFcsYywyQkFBZVAsTSxFQUFRO0FBQUE7O0FBQ3JCLFFBQUksS0FBS0EsTUFBVCxFQUFpQjtBQUNmLFdBQUtBLE1BQUwsQ0FBWU0sSUFBWjtBQUNEOztBQUVELFNBQUtOLE1BQUwsR0FBY0EsTUFBZDs7QUFFQTtBQUNBLFdBQU8sVUFBQ1EsQ0FBRDtBQUFBLGFBQU8sTUFBS1AsTUFBTCxDQUFZTyxDQUFaLENBQVA7QUFBQSxLQUFQO0FBQ0QsRzs7QUF0Q1VaLE8sV0F3Q1hhLFcsd0JBQVlDLFEsRUFBVTtBQUNwQixRQUFJLENBQUMsS0FBS0MsU0FBVixFQUFxQjtBQUNuQixXQUFLQSxTQUFMLEdBQWlCLEVBQWpCO0FBQ0Q7O0FBRUQsUUFBTUMsZ0JBQWdCLEtBQUtELFNBQUwsQ0FBZUUsT0FBZixDQUF1QkgsUUFBdkIsQ0FBdEI7QUFDQSxRQUFJRSxrQkFBa0IsQ0FBQyxDQUF2QixFQUEwQjtBQUN4QixXQUFLRCxTQUFMLENBQWVHLElBQWYsQ0FBb0JKLFFBQXBCO0FBQ0Q7O0FBRUQsV0FBTyxJQUFQO0FBQ0QsRzs7QUFuRFVkLE8sV0FxRFhtQixjLDJCQUFlTCxRLEVBQVU7QUFDdkIsUUFBSSxLQUFLQyxTQUFULEVBQW9CO0FBQ2xCLFVBQU1DLGdCQUFnQixLQUFLRCxTQUFMLENBQWVFLE9BQWYsQ0FBdUJILFFBQXZCLENBQXRCO0FBQ0EsVUFBSUUsZ0JBQWdCLENBQUMsQ0FBckIsRUFBd0I7QUFDdEIsYUFBS0QsU0FBTCxDQUFlSyxNQUFmLENBQXNCSixhQUF0QixFQUFxQyxDQUFyQztBQUNEO0FBQ0Y7O0FBRUQsV0FBTyxJQUFQO0FBQ0QsRzs7QUE5RFVoQixPLFdBZ0VYTyxlLDhCQUFrQjtBQUNoQixRQUFJLEtBQUtRLFNBQVQsRUFBb0I7QUFDbEIsVUFBTU0sZUFBZSxLQUFLTixTQUFMLENBQWVPLE1BQXBDO0FBQ0EsV0FBSyxJQUFJQyxJQUFJLENBQWIsRUFBZ0JBLElBQUlGLFlBQXBCLEVBQWtDRSxHQUFsQyxFQUF1QztBQUNyQyxhQUFLUixTQUFMLENBQWVRLENBQWYsRUFBa0IsS0FBS3BCLE9BQXZCLEVBQWdDLElBQWhDO0FBQ0Q7QUFDRjtBQUNGLEc7O1NBdkVVSCxLOzs7a0JBMEVFLFVBQUNDLFlBQUQ7QUFBQSxTQUFrQixJQUFJRCxLQUFKLENBQVVDLFlBQVYsQ0FBbEI7QUFBQSxDIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNsYXNzIFZhbHVlIHtcbiAgY29uc3RydWN0b3IoaW5pdGlhbFZhbHVlLCB0eXBlKSB7XG4gICAgdGhpcy5jdXJyZW50ID0gaW5pdGlhbFZhbHVlO1xuICAgIHRoaXMudHlwZSA9IHR5cGU7XG4gICAgdGhpcy5hY3Rpb24gPSBudWxsO1xuICB9XG5cbiAgdXBkYXRlKG5ld1ZhbHVlKSB7XG4gICAgdGhpcy5jdXJyZW50ID0gbmV3VmFsdWU7XG4gICAgdGhpcy5fX2ZpcmVMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIGdldCgpIHtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50O1xuICB9XG5cbiAgZ2V0VmVsb2NpdHkoKSB7XG4gICAgcmV0dXJuICh0aGlzLmFjdGlvbikgPyB0aGlzLmFjdGlvbi5nZXRWZWxvY2l0eSA6IDA7XG4gIH1cblxuICBzdG9wKCkge1xuICAgIGlmICh0aGlzLmFjdGlvbikge1xuICAgICAgdGhpcy5hY3Rpb24uc3RvcCgpO1xuICAgICAgdGhpcy5hY3Rpb24gPSBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgcmVnaXN0ZXJBY3Rpb24oYWN0aW9uKSB7XG4gICAgaWYgKHRoaXMuYWN0aW9uKSB7XG4gICAgICB0aGlzLmFjdGlvbi5zdG9wKCk7XG4gICAgfVxuXG4gICAgdGhpcy5hY3Rpb24gPSBhY3Rpb247XG5cbiAgICAvLyBQb3RlbnRpYWwgdG9kbzogQ2hlY2sgaWYgc291cmNlIGFjdGlvbiBpcyB0aGlzLmFjdGlvblxuICAgIHJldHVybiAodikgPT4gdGhpcy51cGRhdGUodik7XG4gIH1cblxuICBhZGRMaXN0ZW5lcihjYWxsYmFjaykge1xuICAgIGlmICghdGhpcy5saXN0ZW5lcnMpIHtcbiAgICAgIHRoaXMubGlzdGVuZXJzID0gW107XG4gICAgfVxuXG4gICAgY29uc3QgbGlzdGVuZXJJbmRleCA9IHRoaXMubGlzdGVuZXJzLmluZGV4T2YoY2FsbGJhY2spO1xuICAgIGlmIChsaXN0ZW5lckluZGV4ID09PSAtMSkge1xuICAgICAgdGhpcy5saXN0ZW5lcnMucHVzaChjYWxsYmFjayk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICByZW1vdmVMaXN0ZW5lcihjYWxsYmFjaykge1xuICAgIGlmICh0aGlzLmxpc3RlbmVycykge1xuICAgICAgY29uc3QgbGlzdGVuZXJJbmRleCA9IHRoaXMubGlzdGVuZXJzLmluZGV4T2YoY2FsbGJhY2spO1xuICAgICAgaWYgKGxpc3RlbmVySW5kZXggPiAtMSkge1xuICAgICAgICB0aGlzLmxpc3RlbmVycy5zcGxpY2UobGlzdGVuZXJJbmRleCwgMSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBfX2ZpcmVMaXN0ZW5lcnMoKSB7XG4gICAgaWYgKHRoaXMubGlzdGVuZXJzKSB7XG4gICAgICBjb25zdCBudW1MaXN0ZW5lcnMgPSB0aGlzLmxpc3RlbmVycy5sZW5ndGg7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bUxpc3RlbmVyczsgaSsrKSB7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzW2ldKHRoaXMuY3VycmVudCwgdGhpcyk7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IChpbml0aWFsVmFsdWUpID0+IG5ldyBWYWx1ZShpbml0aWFsVmFsdWUpO1xuIl19